--Calculate the Total Revenue Generated by Each Location:
SELECT L.LocationName, SUM(P.Amount) AS TotalRevenue
FROM [dbo].[Location] L
JOIN [dbo].[Payment] P ON L.LocationID = P.LocationID
GROUP BY L.LocationName;


--Calculate Total Payments per Location:
SELECT L.LocationName, SUM(P.Amount) AS TotalPayments
FROM [dbo].[Location] L
JOIN [dbo].[Payment] P ON L.LocationID = P.LocationID
GROUP BY L.LocationName;


--Retrieve Payments with Courier Information:
SELECT P.*, C.SenderName, C.ReceiverName, C.Weight, C.Status, C.TrackingNumber, C.DeliveryDate
FROM [dbo].[Payment] P
JOIN [dbo].[Courier] C ON P.CourierID = C.CourierID;

--Retrieve Payments with Location Information:
SELECT P.*, L.LocationName, L.Address
FROM [dbo].[Payment] P
JOIN [dbo].[Location] L ON P.LocationID = L.LocationID;

--Retrieve Payments with Courier and Location Information:
SELECT P.*, C.SenderName, C.ReceiverName, C.Weight, C.Status, C.TrackingNumber, C.DeliveryDate, L.LocationName, L.Address
FROM [dbo].[Payment] P
JOIN [dbo].[Courier] C ON P.CourierID = C.CourierID
JOIN [dbo].[Location] L ON P.LocationID = L.LocationID;

--List All Payments with Courier Details:
SELECT P.*, C.SenderName, C.ReceiverName, C.Weight, C.Status, C.TrackingNumber, C.DeliveryDate
FROM [dbo].[Payment] P
JOIN [dbo].[Courier] C ON P.CourierID = C.CourierID;


--Total Payments Received for Each Courier:
SELECT C.CourierID, SUM(P.Amount) AS TotalPayments
FROM [dbo].[Payment] P
JOIN [dbo].[Courier] C ON P.CourierID = C.CourierID
GROUP BY C.CourierID;

--List Payments Made on a Specific Date:
SELECT *
FROM [dbo].[Payment]
WHERE PaymentDate = '2023-01-11';  

--Get Courier Information for Each Payment:
SELECT P.*, C.*
FROM [dbo].[Payment] P
JOIN [dbo].[Courier] C ON P.CourierID = C.CourierID;


--Get Payment Details with Location:
SELECT P.*, L.*
FROM [dbo].[Payment] P
JOIN [dbo].[Location] L ON P.LocationID = L.LocationID;

--Calculating Total Payments for Each Courier:
SELECT C.CourierID, SUM(P.Amount) AS TotalPayments
FROM [dbo].[Courier] C
JOIN [dbo].[Payment] P ON C.CourierID = P.CourierID
GROUP BY C.CourierID;

--List Payments Within a Date Range:
SELECT *
FROM [dbo].[Payment]
WHERE PaymentDate BETWEEN '2023-01-11' AND '2023-11-11';


--Retrieve a List of All Users and Their Corresponding Courier Records (Including No Matches):
SELECT U.*, C.*
FROM [dbo].[User] U
LEFT JOIN [dbo].[Courier] C ON U.Name = C.SenderName
UNION
SELECT U.*, C.*
FROM [dbo].[User] U
RIGHT JOIN [dbo].[Courier] C ON U.Name = C.SenderName;


---List All Users and All Courier Services, Showing All Possible Combinations:
SELECT U.*, CS.*
FROM [dbo].[User] U
CROSS JOIN [dbo].[CourierServices] CS;

--Retrieve a List of Couriers and Their Corresponding Sender Information (If Available):
SELECT C.*, U.*
FROM [dbo].[Courier] C
LEFT JOIN [dbo].[User] U ON C.SenderName = U.Name;

--Retrieve a List of Locations and the Total Payment Amount Received at Each Location:
SELECT L.LocationName, SUM(P.Amount) AS TotalPayment
FROM [dbo].[Location] L
JOIN [dbo].[Payment] P ON L.LocationID = P.LocationID
GROUP BY L.LocationName;
